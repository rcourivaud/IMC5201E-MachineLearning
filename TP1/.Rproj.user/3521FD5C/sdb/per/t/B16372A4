{
    "contents" : "#Data preparation\nFluTrain <- read.csv(\"U:/Cours/IMC-5101B/TP1/FluTrain.csv\", header=FALSE)\n\ncolnames(FluTrain) = c(\"Weeks\", \"ILI\", \"Queries\")\n\nattach(FluTrain)\n\ninstall.packages(\"tidyr\")\nlibrary(tidyr)\n\nFluTrain = separate(data = FluTrain, col = Weeks, into = c(\"date1\", \"date2\"), sep = \" - \" )\nFluTrain$date1 = strptime(FluTrain$date1,format=\"%Y-%m-%d\")\nFluTrain$date2 = strptime(FluTrain$date2,format=\"%Y-%m-%d\")\nFluTrain$year = FluTrain$date1$year + 1900\nFluTrain$week = as.numeric( format(FluTrain$date1+3, \"%U\"))\nFluTrain$day = FluTrain$date1$nday\nFluTrain$month = FluTrain$date1$mon+1\n\n\n\nplot(ILI,Queries)\n\n\nFluTrain20042011 <- subset(FluTrain, year > 2004)\ndetach(FluTrain20042011)\nplot(FluTrain20042011$ILI,FluTrain20042011$Queries)\ntable(as.factor(year))\n\n#Cycle of Iliness over years \nplot(FluTrain20042011$ILI)\nplot(FluTrain20042011$Queries)\n\n#2.1.1\n\n# Question 1)\n\nFluTrain20042011[FluTrain20042011$ILI==max(FluTrain20042011$ILI),]\n\npaste(\"The week is \",FluTrain20042011[FluTrain20042011$ILI==max(FluTrain20042011$ILI),]$week)\npaste(\"The day is \",FluTrain20042011[FluTrain20042011$ILI==max(FluTrain20042011$ILI),]$date1$mday)\npaste(\"The month is \",FluTrain20042011[FluTrain20042011$ILI==max(FluTrain20042011$ILI),]$date1$mon+1)\n\n\n# Question 2)\n\nFluTrain20042011[FluTrain20042011$Queries==max(FluTrain20042011$Queries),]\n\npaste(\"The week is \",FluTrain20042011[FluTrain20042011$Queries==max(FluTrain20042011$Queries),]$week)\npaste(\"The day is \",FluTrain20042011[FluTrain20042011$Queries==max(FluTrain20042011$Queries),]$date1$mday)\npaste(\"The month is \",FluTrain20042011[FluTrain20042011$Queries==max(FluTrain20042011$Queries),]$date1$mon+1)\n\n#2.1.2\n\nhistoILI = hist(FluTrain$ILI)\n#Most of the ILI values are small, with a relatively small number of much larger values (in statistics, this sort of data is called \"skew right\").\n\n#2.2.3\n\nplot((log(FluTrain$ILI)~(FluTrain$Queries)))\n#There is a positive, linear relationship between log(ILI) and Queries.\n\n#2.2.4\n#log(ILI) = \f0 + \f1  Queries, where the slope \f1 is positive.  ( SIXTH answer)\n\n#2.2.5\n\nFluTrend1 = lm(log(ILI) ~ Queries, data=FluTrain)\nsummary(FluTrend1)\n\nmseTrend1.1 = sum(FluTrend1$residuals**2)/length(FluTrend1$residuals)\nmseTrend1.2 = sum(((predict(FluTrend1, FluTrain)-log(FluTrain$ILI))**2))/length(FluTrain$ILI)\n\nRsquared = summary(FluTrend1)$r.squared\nRsquared\n\n#2.3\n\nFluTest <- read.csv(\"U:/Cours/IMC-5101B/TP1/FluTest.csv\", header=FALSE)\n\ncolnames(FluTest) = c(\"Weeks\", \"ILI\", \"Queries\")\n\nhead(FluTest)\n#2.3.6\npaste(\"Predicted value for 11th March 2012 : \" ,exp(predict(FluTrend1, FluTest[FluTest$Weeks==\"2012-03-11 - 2012-03-17\",])))\n#2.3.7\npaste(\"The real value for 11th March 2012 : \" ,FluTest[FluTest$Weeks==\"2012-03-11 - 2012-03-17\",]$ILI)\npaste(\"Squared error : \" ,(exp(predict(FluTrend1, FluTest[FluTest$Weeks==\"2012-03-11 - 2012-03-17\",]))-FluTest[FluTest$Weeks==\"2012-03-11 - 2012-03-17\",]$ILI)**2)\n\n#2.3.8\nsum(((exp(predict(FluTrend1, FluTest))-FluTest$ILI)**2))/length(FluTest$ILI)\nlibrary(hydroGOF)\n\n#2.4\n#2.4.9\n\nFluTrain$ILI_Lag2 = c(c(NA, NA), as.vector(FluTrain$ILI[0:415]))\nplot(log(FluTrain$ILI_Lag2)~FluTrain$ILI)\n#There is a strong positive relationship between log(ILI Lag2) and log(ILI).\n\n#2.4.10\nFluTrend2 = lm(log(ILI) ~ Queries + log(ILI_Lag2) , data = FluTrain)\nsummary(FluTrend2)\n\nsummary(FluTrend2)$r.squared\nmean((predict(FluTrend2, FluTrain)-FluTrain$ILI)**2, na.rm=TRUE)\n",
    "created" : 1479305267667.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2631311556",
    "id" : "B16372A4",
    "lastKnownWriteTime" : 1479315509,
    "path" : "U:/Cours/IMC-5101B/TP1/Script.R",
    "project_path" : "Script.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}